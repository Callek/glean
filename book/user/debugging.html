<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Debugging products using Glean - Glean - Cross-platform Telemetry library</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../tabs.css">
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li><a href="../index.html"><strong aria-hidden="true">1.</strong> Glean</a></li><li><a href="../user/index.html"><strong aria-hidden="true">2.</strong> Using the Glean SDK</a></li><li><ol class="section"><li><a href="../user/adding-glean-to-your-project.html"><strong aria-hidden="true">2.1.</strong> Adding Glean to your project</a></li><li><a href="../user/adding-new-metrics.html"><strong aria-hidden="true">2.2.</strong> Adding new metrics</a></li><li><a href="../user/metric-parameters.html"><strong aria-hidden="true">2.3.</strong> Metric parameters</a></li><li><a href="../user/testing-metrics.html"><strong aria-hidden="true">2.4.</strong> Testing metrics</a></li><li><a href="../user/debugging.html" class="active"><strong aria-hidden="true">2.5.</strong> Debugging products using Glean</a></li><li><a href="../user/error-reporting.html"><strong aria-hidden="true">2.6.</strong> Error reporting</a></li><li><a href="../user/experiments-api.html"><strong aria-hidden="true">2.7.</strong> Using the experiments API</a></li><li><a href="../user/metrics/index.html"><strong aria-hidden="true">2.8.</strong> Metric types</a></li><li><ol class="section"><li><a href="../user/metrics/boolean.html"><strong aria-hidden="true">2.8.1.</strong> Boolean</a></li><li><a href="../user/metrics/counter.html"><strong aria-hidden="true">2.8.2.</strong> Counter</a></li><li><a href="../user/metrics/labeled_counters.html"><strong aria-hidden="true">2.8.3.</strong> Labeled Counters</a></li><li><a href="../user/metrics/string.html"><strong aria-hidden="true">2.8.4.</strong> String</a></li><li><a href="../user/metrics/labeled_strings.html"><strong aria-hidden="true">2.8.5.</strong> Labeled Strings</a></li><li><a href="../user/metrics/string_list.html"><strong aria-hidden="true">2.8.6.</strong> String List</a></li><li><a href="../user/metrics/timespan.html"><strong aria-hidden="true">2.8.7.</strong> Timespan</a></li><li><a href="../user/metrics/timing_distribution.html"><strong aria-hidden="true">2.8.8.</strong> Timing Distribution</a></li><li><a href="../user/metrics/memory_distribution.html"><strong aria-hidden="true">2.8.9.</strong> Memory Distribution</a></li><li><a href="../user/metrics/uuid.html"><strong aria-hidden="true">2.8.10.</strong> UUID</a></li><li><a href="../user/metrics/datetime.html"><strong aria-hidden="true">2.8.11.</strong> Datetime</a></li><li><a href="../user/metrics/event.html"><strong aria-hidden="true">2.8.12.</strong> Event</a></li><li><a href="../user/metrics/custom_distribution.html"><strong aria-hidden="true">2.8.13.</strong> Custom Distribution</a></li><li><a href="../user/metrics/quantity.html"><strong aria-hidden="true">2.8.14.</strong> Quantity</a></li></ol></li><li><a href="../user/pings/index.html"><strong aria-hidden="true">2.9.</strong> Pings</a></li><li><ol class="section"><li><a href="../user/pings/baseline.html"><strong aria-hidden="true">2.9.1.</strong> Baseline Ping</a></li><li><a href="../user/pings/metrics.html"><strong aria-hidden="true">2.9.2.</strong> Metrics Ping</a></li><li><a href="../user/pings/events.html"><strong aria-hidden="true">2.9.3.</strong> Events Ping</a></li><li><a href="../user/pings/custom.html"><strong aria-hidden="true">2.9.4.</strong> Custom Pings</a></li><li><a href="../user/pings/testing-custom-pings.html"><strong aria-hidden="true">2.9.5.</strong> Testing custom pings</a></li></ol></li><li><a href="../user/android-build-configuration-options.html"><strong aria-hidden="true">2.10.</strong> Android build configuration options</a></li><li><a href="../user/focused-use-cases.html"><strong aria-hidden="true">2.11.</strong> Focused Use Cases</a></li><li><ol class="section"><li><a href="../user/instrument-android-crashes-example.html"><strong aria-hidden="true">2.11.1.</strong> Instrumenting Android Crashes With Glean</a></li></ol></li></ol></li><li><a href="../user/collected-metrics/metrics.html"><strong aria-hidden="true">3.</strong> Metrics collected by the Glean SDK</a></li><li><a href="../dev/index.html"><strong aria-hidden="true">4.</strong> Developing the Glean SDK</a></li><li><ol class="section"><li><a href="../dev/testing.html"><strong aria-hidden="true">4.1.</strong> Testing</a></li><li><a href="../dev/android/index.html"><strong aria-hidden="true">4.2.</strong> Android bindings</a></li><li><ol class="section"><li><a href="../dev/android/setup-android-build-environment.html"><strong aria-hidden="true">4.2.1.</strong> Setup Build Environment</a></li></ol></li><li><a href="../dev/ios/index.html"><strong aria-hidden="true">4.3.</strong> iOS bindings</a></li><li><ol class="section"><li><a href="../dev/ios/setup-ios-build-environment.html"><strong aria-hidden="true">4.3.1.</strong> Setup Build Environment</a></li><li><a href="../dev/ios/debug-glean-on-ios.html"><strong aria-hidden="true">4.3.2.</strong> Debugging Different Versions of Glean</a></li></ol></li><li><a href="../dev/core/index.html"><strong aria-hidden="true">4.4.</strong> Rust Component</a></li><li><ol class="section"><li><a href="../dev/core/dependency-management.html"><strong aria-hidden="true">4.4.1.</strong> Dependency Management</a></li><li><a href="../dev/core/new-metric-type.html"><strong aria-hidden="true">4.4.2.</strong> Adding a new metric type</a></li><li><ol class="section"><li><a href="../dev/core/new-metric-type/ffi.html"><strong aria-hidden="true">4.4.2.1.</strong> FFI</a></li><li><a href="../dev/core/new-metric-type/kotlin.html"><strong aria-hidden="true">4.4.2.2.</strong> Kotlin</a></li><li><a href="../dev/core/new-metric-type/swift.html"><strong aria-hidden="true">4.4.2.3.</strong> Swift</a></li></ol></li></ol></li><li><a href="../dev/ffi/index.html"><strong aria-hidden="true">4.5.</strong> FFI Layer</a></li><li><ol class="section"><li><a href="../dev/ffi/when-to-use-what-in-the-ffi.html"><strong aria-hidden="true">4.5.1.</strong> When/How FFI</a></li></ol></li><li><a href="../dev/cut-a-new-release.html"><strong aria-hidden="true">4.6.</strong> Release process</a></li><li><a href="../contributing.html"><strong aria-hidden="true">4.7.</strong> Contributing</a></li><li><ol class="section"><li><a href="../code_coverage.html"><strong aria-hidden="true">4.7.1.</strong> Code coverage</a></li></ol></li><li><a href="../dev/core/internal/index.html"><strong aria-hidden="true">4.8.</strong> Internal implementation details</a></li><li><ol class="section"><li><a href="../dev/core/internal/reserved-ping-names.html"><strong aria-hidden="true">4.8.1.</strong> Reserved ping names</a></li><li><a href="../dev/core/internal/clearing.html"><strong aria-hidden="true">4.8.2.</strong> Clearing metrics when disabling/enabling Glean</a></li><li><a href="../dev/core/internal/payload.html"><strong aria-hidden="true">4.8.3.</strong> Payload format</a></li><li><a href="../dev/core/internal/directory-structure.html"><strong aria-hidden="true">4.8.4.</strong> Directory structure</a></li></ol></li></ol></li><li><a href="../api/index.html"><strong aria-hidden="true">5.</strong> API Documentation</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Glean - Cross-platform Telemetry library</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#debugging-products-using-the-glean-sdk" id="debugging-products-using-the-glean-sdk">Debugging products using the Glean SDK</a></h1>
<p>The Glean SDK exports the <code>GleanDebugActivity</code> that can be used to toggle debugging features on or off.
Users can invoke this special activity, at run-time, using the following <a href="https://developer.android.com/studio/command-line/adb"><code>adb</code></a> command:</p>
<p><code>adb shell am start -n [applicationId]/mozilla.telemetry.glean.debug.GleanDebugActivity [extra keys]</code></p>
<blockquote>
<p><strong>Note:</strong> In previous versions of Glean the activity was available with the name <code>mozilla.components.service.glean.debug.GleanDebugActivity</code>.</p>
<p>If you're debugging an old build, try running:
<code>adb shell am start -n [applicationId]/mozilla.components.service.glean.debug.GleanDebugActivity [extra keys]</code></p>
</blockquote>
<p>In the above:</p>
<ul>
<li>
<p><code>[applicationId]</code> is the product's application id as defined in the manifest file and/or build script. For the Glean sample application, this is <code>org.mozilla.samples.glean</code> for a release build and <code>org.mozilla.samples.glean.debug</code> for a debug build.</p>
</li>
<li>
<p><code>[extra keys]</code> is a list of extra keys to be passed to the debug activity. See the <a href="https://developer.android.com/studio/command-line/adb#IntentSpec">documentation</a> for the command line switches used to pass the extra keys.
These are the currently supported keys:</p>
</li>
</ul>
<table><thead><tr><th>key</th><th>type</th><th>description</th></tr></thead><tbody>
<tr><td>logPings</td><td>boolean (--ez)</td><td>If set to <code>true</code>, pings are dumped to logcat; defaults to <code>false</code></td></tr>
<tr><td>sendPing</td><td>string (--es)</td><td>Sends the ping with the given name immediately</td></tr>
<tr><td>tagPings</td><td>string (--es)</td><td>Tags all outgoing pings as debug pings to make them available for real-time validation, on the <a href="https://docs.telemetry.mozilla.org/concepts/glean/debug_ping_view.html">Glean Debug View</a>. The value must match the pattern <code>[a-zA-Z0-9-]{1,20}</code></td></tr>
</tbody></table>
<p>For example, to direct a release build of the Glean sample application to (1) dump pings to logcat, (2) tag the ping with the <code>test-metrics-ping</code> tag, and (3) send the &quot;metrics&quot; ping immediately, the following command can be used:</p>
<pre><code>adb shell am start -n org.mozilla.samples.glean/mozilla.telemetry.glean.debug.GleanDebugActivity \
  --ez logPings true \
  --es sendPing metrics \
  --es tagPings test-metrics-ping
</code></pre>
<blockquote>
<p><strong>Note:</strong> In previous versions of Glean the activity was available with the name <code>mozilla.components.service.glean.debug.GleanDebugActivity</code>.</p>
<p>If you're debugging an old build, try running:</p>
<pre><code>adb shell am start -n org.mozilla.samples.glean/mozilla.components.service.glean.debug.GleanDebugActivity \
  --ez logPings true \
  --es sendPing metrics \
  --es tagPings test-metrics-ping
</code></pre>
</blockquote>
<h3><a class="header" href="#important-gleandebugactivity-notes" id="important-gleandebugactivity-notes">Important GleanDebugActivity notes!</a></h3>
<ul>
<li>
<p>Options that are set using the adb flags are not immediately reset and will persist until the application is closed or manually reset.</p>
</li>
<li>
<p>There are a couple different ways in which to send pings through the GleanDebugActivity.</p>
<ol>
<li>You can use the <code>GleanDebugActivity</code> in order to tag pings and trigger them manually using the UI.  This should always produce a ping with all required fields.</li>
<li>You can use the <code>GleanDebugActivity</code> to tag <em>and</em> send pings.  This has the side effect of potentially sending a ping which does not include all fields because <code>sendPings</code> triggers pings to be sent before certain application behaviors can occur which would record that information.  For example, <code>duration</code> is not calculated or included in a baseline ping sent with <code>sendPing</code> because it forces the ping to be sent before the <code>duration</code> metric has been recorded.</li>
</ol>
</li>
</ul>
<h2><a class="header" href="#glean-log-messages" id="glean-log-messages">Glean Log messages</a></h2>
<p>Glean logs warnings and errors through the Android logging framework.
When running a Glean-powered app in the Android emulator or on a device connected to your computer via cable, there are several ways to read the log output.</p>
<h3><a class="header" href="#android-studio" id="android-studio">Android Studio</a></h3>
<p>Android Studio can show the logs of a connected emulator or device.
To display the log messages for an app:</p>
<ol>
<li>Run an app on your device.</li>
<li>Click <strong>View &gt; Tool Windows &gt; Logcat</strong> (or click <strong>Logcat</strong> in the tool window bar).</li>
</ol>
<p>The Logcat window will show all log messages and allows to filter those by the application ID.
Select the application ID of the product you're debugging.
You can also filter by <code>Glean</code> only.</p>
<p>More information can be found in the <a href="https://developer.android.com/studio/debug/am-logcat">View Logs with Logcat</a> help article.</p>
<h3><a class="header" href="#command-line" id="command-line">Command line</a></h3>
<p>On the command line you can show all of the log output using:</p>
<pre><code>adb logcat
</code></pre>
<p>This is the unfiltered output of all log messages.
You can match for <code>glean</code> using grep:</p>
<pre><code>adb logcat | grep -i glean
</code></pre>
<p>A simple way to filter for only the application that is being debugged is by using <a href="https://github.com/JakeWharton/pidcat">pidcat</a>, a wrapper around <code>adb</code>, which adds colors and proper filtering by application ID and log level.
Run it like this to filter for an application:</p>
<pre><code>pidcat [applicationId]
</code></pre>
<p>In the above <code>[applicationId]</code> is the product's application id as defined in the manifest file and/or build script. For the Glean sample application, this is <code>org.mozilla.samples.glean</code> for a release build and <code>org.mozilla.samples.glean.debug</code> for a debug build.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../user/testing-metrics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../user/error-reporting.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../user/testing-metrics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../user/error-reporting.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../tabs.js"></script>
        

        

    </body>
</html>
